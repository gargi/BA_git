    %Date: 07.01.2016
    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{import} \PY{n+nn}{math}
\PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{linear\PYZus{}model} \PY{k}{as} \PY{n}{linMod}
\PY{k+kn}{import} \PY{n+nn}{toolbox} \PY{k}{as} \PY{n+nn}{tb}\PY{p}{;}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    We generate toydata

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c}{\PYZsh{}toydata shall have n vectors with 5 dimensions}
\PY{n}{n} \PY{o}{=} \PY{l+m+mi}{100000}
\PY{c}{\PYZsh{}probability for signal\PYZhy{}label}
\PY{n}{s\PYZus{}prob} \PY{o}{=} \PY{l+m+mf}{0.05}
\PY{n}{dim} \PY{o}{=} \PY{l+m+mi}{4}
\PY{n}{data} \PY{o}{=} \PY{n}{tb}\PY{o}{.}\PY{n}{createToyData}\PY{p}{(}\PY{n}{n}\PY{p}{,}\PY{n}{dim}\PY{p}{,}\PY{n}{s\PYZus{}prob}\PY{p}{)}
\PY{n}{weights} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{labels} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{x\PYZus{}1} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}
\PY{n}{x\PYZus{}2} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    visualize

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{o}{\PYZpc{}}\PY{k}{pylab} inline
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x\PYZus{}1}\PY{p}{,} \PY{n}{x\PYZus{}2}\PY{p}{,} \PY{n}{edgecolor}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{labels}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}

\par\vspace{1\smallerfontscale}%
    \needspace{4\baselineskip}%
    % Only render the prompt if the cell is pyout.  Note, the outputs prompt 
    % block isn't used since we need to check each indiviual output and only
    % add prompts to the pyout ones.
    %
    %
    \begin{addmargin}[\cellleftmargin]{0em}% left, right
    {\smaller%
    \vspace{-1\smallerfontscale}%
    
    \begin{Verbatim}[commandchars=\\\{\}]
Populating the interactive namespace from numpy and matplotlib
    \end{Verbatim}
}%
    \end{addmargin}%\par\vspace{1\smallerfontscale}%
    \needspace{4\baselineskip}%
    % Only render the prompt if the cell is pyout.  Note, the outputs prompt 
    % block isn't used since we need to check each indiviual output and only
    % add prompts to the pyout ones.
    %
    %
    \begin{addmargin}[\cellleftmargin]{0em}% left, right
    {\smaller%
    \vspace{-1\smallerfontscale}%
    
    
    
    \begin{verbatim}
<matplotlib.collections.PathCollection at 0x57b5160>
    \end{verbatim}

    
}%
    \end{addmargin}%\par\vspace{1\smallerfontscale}%
    \needspace{4\baselineskip}%
    % Only render the prompt if the cell is pyout.  Note, the outputs prompt 
    % block isn't used since we need to check each indiviual output and only
    % add prompts to the pyout ones.
    %
    %
    \begin{addmargin}[\cellleftmargin]{0em}% left, right
    {\smaller%
    \vspace{-1\smallerfontscale}%
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{noteLogReg_files/noteLogReg_5_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    }%
    \end{addmargin}%
    split toydata into training- and testset for the classifier

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{n\PYZus{}train} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{n}\PY{o}{/}\PY{l+m+mi}{10}\PY{p}{)}

\PY{n}{train\PYZus{}x\PYZus{}1}\PY{p}{,}\PY{n}{test\PYZus{}x\PYZus{}1} \PY{o}{=} \PY{n}{tb}\PY{o}{.}\PY{n}{splitList}\PY{p}{(}\PY{n}{x\PYZus{}1}\PY{p}{,}\PY{n}{n\PYZus{}train}\PY{p}{)}
\PY{n}{train\PYZus{}x\PYZus{}2}\PY{p}{,}\PY{n}{test\PYZus{}x\PYZus{}2} \PY{o}{=} \PY{n}{tb}\PY{o}{.}\PY{n}{splitList}\PY{p}{(}\PY{n}{x\PYZus{}2}\PY{p}{,}\PY{n}{n\PYZus{}train}\PY{p}{)}
\PY{n}{train\PYZus{}labels}\PY{p}{,}\PY{n}{test\PYZus{}labels} \PY{o}{=} \PY{n}{tb}\PY{o}{.}\PY{n}{splitList}\PY{p}{(}\PY{n}{labels}\PY{p}{,}\PY{n}{n\PYZus{}train}\PY{p}{)}
\PY{n}{test\PYZus{}weights} \PY{o}{=} \PY{n}{tb}\PY{o}{.}\PY{n}{splitList}\PY{p}{(}\PY{n}{weights}\PY{p}{,}\PY{n}{n\PYZus{}train}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    For Comparison, we calculate the best possible AMS\\
(case: every signal correctly detected)

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{tb}\PY{o}{.}\PY{n}{calcMaxAMS}\PY{p}{(}\PY{n}{test\PYZus{}weights}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}

\par\vspace{1\smallerfontscale}%
    \needspace{4\baselineskip}%
    % Only render the prompt if the cell is pyout.  Note, the outputs prompt 
    % block isn't used since we need to check each indiviual output and only
    % add prompts to the pyout ones.
    %
    %
    \begin{addmargin}[\cellleftmargin]{0em}% left, right
    {\smaller%
    \vspace{-1\smallerfontscale}%
    
    \begin{Verbatim}[commandchars=\\\{\}]
Found 4474 signals.
Weightsums signal: 112.519230558 | background: 0
Maximum AMS possible with this Data: 19.721820983450662
    \end{Verbatim}
}%
    \end{addmargin}%
    we initialize the Logistic Regression Classifier, shape the input-data
and fit the model

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{logReg} \PY{o}{=} \PY{n}{linMod}\PY{o}{.}\PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mi}{1}\PY{n}{e5}\PY{p}{)}

\PY{n}{train\PYZus{}x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{train\PYZus{}x\PYZus{}1}\PY{p}{,}\PY{n}{train\PYZus{}x\PYZus{}2}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
\PY{n}{test\PYZus{}x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{test\PYZus{}x\PYZus{}1}\PY{p}{,}\PY{n}{test\PYZus{}x\PYZus{}2}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
\PY{n}{train\PYZus{}labels} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{train\PYZus{}labels}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
\PY{n}{test\PYZus{}labels} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}

\PY{n}{logReg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}x}\PY{p}{,}\PY{n}{train\PYZus{}labels}\PY{p}{)}

\PY{n}{logReg}\PY{o}{.}\PY{n}{sparsify}\PY{p}{(}\PY{p}{)}

\PY{n}{predProb} \PY{o}{=} \PY{n}{logReg}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{test\PYZus{}x}\PY{p}{)}
\PY{n}{pred} \PY{o}{=} \PY{n}{logReg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}x}\PY{p}{)}
\PY{n}{score} \PY{o}{=} \PY{n}{logReg}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{test\PYZus{}x}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Score:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{score}\PY{p}{)}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}

\par\vspace{1\smallerfontscale}%
    \needspace{4\baselineskip}%
    % Only render the prompt if the cell is pyout.  Note, the outputs prompt 
    % block isn't used since we need to check each indiviual output and only
    % add prompts to the pyout ones.
    %
    %
    \begin{addmargin}[\cellleftmargin]{0em}% left, right
    {\smaller%
    \vspace{-1\smallerfontscale}%
    
    \begin{Verbatim}[commandchars=\\\{\}]
Score: 0.999833333333
    \end{Verbatim}
}%
    \end{addmargin}%
    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{s}\PY{p}{,}\PY{n}{b} \PY{o}{=} \PY{n}{tb}\PY{o}{.}\PY{n}{calcWeightSums}\PY{p}{(}\PY{n}{test\PYZus{}weights}\PY{p}{,}\PY{n}{pred}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{AMS:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{tb}\PY{o}{.}\PY{n}{calcAMS}\PY{p}{(}\PY{n}{s}\PY{p}{,}\PY{n}{b}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}

\par\vspace{1\smallerfontscale}%
    \needspace{4\baselineskip}%
    % Only render the prompt if the cell is pyout.  Note, the outputs prompt 
    % block isn't used since we need to check each indiviual output and only
    % add prompts to the pyout ones.
    %
    %
    \begin{addmargin}[\cellleftmargin]{0em}% left, right
    {\smaller%
    \vspace{-1\smallerfontscale}%
    
    \begin{Verbatim}[commandchars=\\\{\}]
AMS: 18.392472651997792
    \end{Verbatim}
}%
    \end{addmargin}%
    We successfully tested logistic Regression, now let's use it on actual
CERN-Data.

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{kaggleData} \PY{k}{as} \PY{n+nn}{kD}\PY{p}{;}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{csvDict}\PY{p}{,}\PY{n}{header} \PY{o}{=} \PY{n}{kD}\PY{o}{.}\PY{n}{createCsvDictionary}\PY{p}{(}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    Trainingset has key ``t''\\
Public Testset has key ``b''\\
Private Testset has key ``v''

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{getFeatureSets}\PY{p}{(}\PY{n}{featureName}\PY{p}{,}\PY{n}{testset} \PY{o}{=} \PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{v}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
    \PY{n}{trainFeature} \PY{o}{=} \PY{n}{kD}\PY{o}{.}\PY{n}{getFeatureAsNpArray}\PY{p}{(}
        \PY{n}{csvDict}\PY{p}{,}\PY{n}{header}\PY{p}{,}\PY{n}{featureName}\PY{p}{,}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{t}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{hasErrorValues} \PY{o}{=} \PY{k}{True}\PY{p}{)}
    \PY{n}{testFeature} \PY{o}{=} \PY{n}{kD}\PY{o}{.}\PY{n}{getFeatureAsNpArray}\PY{p}{(}
        \PY{n}{csvDict}\PY{p}{,}\PY{n}{header}\PY{p}{,}\PY{n}{featureName}\PY{p}{,}\PY{n}{testset}\PY{p}{,}\PY{n}{hasErrorValues} \PY{o}{=} \PY{k}{True}\PY{p}{)}
    \PY{k}{return} \PY{n}{trainFeature}\PY{p}{,} \PY{n}{testFeature}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{train\PYZus{}eventList}\PY{p}{,}\PY{n}{test\PYZus{}eventList} \PY{o}{=} \PY{n}{getFeatureSets}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{EventId}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\PY{n}{train\PYZus{}labels}\PY{p}{,}\PY{n}{test\PYZus{}labels} \PY{o}{=} \PY{n}{getFeatureSets}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Label}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\PY{n}{test\PYZus{}weights} \PY{o}{=} \PY{n}{getFeatureSets}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{KaggleWeight}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    How are labels and weights related?

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{signal\PYZus{}sum} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{test\PYZus{}labels}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{n}{background\PYZus{}sum} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{signal\PYZus{}sum}\PY{p}{)}
\PY{n}{signal\PYZus{}weight} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{background\PYZus{}weight} \PY{o}{=} \PY{l+m+mi}{0}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{test\PYZus{}labels}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{signal\PYZus{}weight} \PY{o}{+}\PY{o}{=} \PY{n}{test\PYZus{}weights}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{background\PYZus{}weight} \PY{o}{+}\PY{o}{=} \PY{n}{test\PYZus{}weights}\PY{p}{[}\PY{n}{i}\PY{p}{]}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Mean of background\PYZhy{}weights:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{background\PYZus{}weight}\PY{o}{/}\PY{n}{background\PYZus{}sum}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Mean of signal\PYZhy{}weights:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{signal\PYZus{}weight}\PY{o}{/}\PY{n}{signal\PYZus{}sum}\PY{p}{)}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}

\par\vspace{1\smallerfontscale}%
    \needspace{4\baselineskip}%
    % Only render the prompt if the cell is pyout.  Note, the outputs prompt 
    % block isn't used since we need to check each indiviual output and only
    % add prompts to the pyout ones.
    %
    %
    \begin{addmargin}[\cellleftmargin]{0em}% left, right
    {\smaller%
    \vspace{-1\smallerfontscale}%
    
    \begin{Verbatim}[commandchars=\\\{\}]
Mean of background-weights: 1.38702756616
Mean of signal-weights: 0.00450270106462
    \end{Verbatim}
}%
    \end{addmargin}%
    We observe that False signals are weighted a lot heavier than True
signals.

    If a classifier achieved a higher AMS while detecting less signals,\\
we can make statements about the usabilty of the features, the
classifier used.

We choose features with beneficial properties for classifying.

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{p}{(}\PY{n}{train\PYZus{}DER\PYZus{}met\PYZus{}phi\PYZus{}centrality}\PY{p}{,}
 \PY{n}{test\PYZus{}DER\PYZus{}met\PYZus{}phi\PYZus{}centrality}\PY{p}{)} \PY{o}{=} \PY{n}{getFeatureSets}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{DER\PYZus{}met\PYZus{}phi\PYZus{}centrality}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\PY{p}{(}\PY{n}{train\PYZus{}DER\PYZus{}pt\PYZus{}ratio\PYZus{}lep\PYZus{}tau}\PY{p}{,}
 \PY{n}{test\PYZus{}DER\PYZus{}pt\PYZus{}ratio\PYZus{}lep\PYZus{}tau}\PY{p}{)} \PY{o}{=} \PY{n}{getFeatureSets}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{DER\PYZus{}pt\PYZus{}ratio\PYZus{}lep\PYZus{}tau}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    Using DER\_mass\_MMC was not allowed in the former contest, we use it
here anyway to test our classifier

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{p}{(}\PY{n}{train\PYZus{}DER\PYZus{}mass\PYZus{}MMC}\PY{p}{,}
 \PY{n}{test\PYZus{}DER\PYZus{}mass\PYZus{}MMC}\PY{p}{)} \PY{o}{=} \PY{n}{getFeatureSets}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{DER\PYZus{}mass\PYZus{}MMC}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{train\PYZus{}labels} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{train\PYZus{}labels}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
\PY{n}{test\PYZus{}labels} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{tb}\PY{o}{.}\PY{n}{calcMaxAMS}\PY{p}{(}\PY{n}{test\PYZus{}weights}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}

\par\vspace{1\smallerfontscale}%
    \needspace{4\baselineskip}%
    % Only render the prompt if the cell is pyout.  Note, the outputs prompt 
    % block isn't used since we need to check each indiviual output and only
    % add prompts to the pyout ones.
    %
    %
    \begin{addmargin}[\cellleftmargin]{0em}% left, right
    {\smaller%
    \vspace{-1\smallerfontscale}%
    
    \begin{Verbatim}[commandchars=\\\{\}]
Found 153683 signals.
Weightsums signal: 691.988607714 | background: 0
Maximum AMS possible with this Data: 67.71112289514173
    \end{Verbatim}
}%
    \end{addmargin}%
    We start with one feature and add more with every regression to see
improvement of the AMS

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{logisticReg}\PY{p}{(}\PY{n}{train\PYZus{}x}\PY{p}{,}\PY{n}{train\PYZus{}labels}\PY{p}{,}\PY{n}{test\PYZus{}x}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{:}
    \PY{n}{logReg} \PY{o}{=} \PY{k}{None}
    \PY{n}{logReg} \PY{o}{=} \PY{n}{linMod}\PY{o}{.}\PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mi}{1}\PY{n}{e5}\PY{p}{)}
    \PY{n}{logReg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}x}\PY{p}{,}\PY{n}{train\PYZus{}labels}\PY{p}{)}
    \PY{n}{logReg}\PY{o}{.}\PY{n}{sparsify}\PY{p}{(}\PY{p}{)}
    \PY{n}{predProb} \PY{o}{=} \PY{n}{logReg}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{test\PYZus{}x}\PY{p}{)}
    \PY{n}{pred} \PY{o}{=} \PY{n}{logReg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}x}\PY{p}{)}
    \PY{n}{signals} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{pred}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}  
    \PY{k}{return} \PY{n}{predProb}\PY{p}{,}\PY{n}{pred}\PY{p}{,}\PY{n}{score}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{logRegFor}\PY{p}{(}\PY{n}{fList}\PY{p}{)}\PY{p}{:}
    \PY{k}{for} \PY{n}{feature} \PY{o+ow}{in} \PY{n}{fList}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Feature:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{feature}\PY{p}{)}
        \PY{n}{trainList\PYZus{}x}\PY{p}{,}\PY{n}{testList\PYZus{}x} \PY{o}{=} \PY{n}{kD}\PY{o}{.}\PY{n}{getFeatureSets}\PY{p}{(}\PY{n}{feature}\PY{p}{)}
        \PY{n}{train\PYZus{}x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{trainList\PYZus{}x}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
        \PY{n}{test\PYZus{}x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{testList\PYZus{}x}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
        \PY{n}{logisticReg}\PY{p}{(}\PY{n}{train\PYZus{}x}\PY{p}{,}\PY{n}{train\PYZus{}labels}\PY{p}{,}\PY{n}{test\PYZus{}x}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{;}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{p}{(}\PY{n}{train\PYZus{}PRI\PYZus{}tau\PYZus{}pt}\PY{p}{,}
 \PY{n}{test\PYZus{}PRI\PYZus{}tau\PYZus{}pt}\PY{p}{)} \PY{o}{=} \PY{n}{getFeatureSets}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{PRI\PYZus{}tau\PYZus{}pt}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\PY{p}{(}\PY{n}{train\PYZus{}DER\PYZus{}met\PYZus{}phi\PYZus{}centrality}\PY{p}{,}
 \PY{n}{test\PYZus{}DER\PYZus{}met\PYZus{}phi\PYZus{}centrality}\PY{p}{)} \PY{o}{=} \PY{n}{getFeatureSets}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{DER\PYZus{}met\PYZus{}phi\PYZus{}centrality}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\PY{p}{(}\PY{n}{train\PYZus{}DER\PYZus{}pt\PYZus{}h}\PY{p}{,}
 \PY{n}{test\PYZus{}DER\PYZus{}pt\PYZus{}h}\PY{p}{)} \PY{o}{=} \PY{n}{getFeatureSets}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{DER\PYZus{}pt\PYZus{}h}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\PY{p}{(}\PY{n}{train\PYZus{}DER\PYZus{}pt\PYZus{}ratio\PYZus{}lep\PYZus{}tau}\PY{p}{,}
 \PY{n}{test\PYZus{}DER\PYZus{}pt\PYZus{}ratio\PYZus{}lep\PYZus{}tau}\PY{p}{)} \PY{o}{=} \PY{n}{getFeatureSets}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{DER\PYZus{}pt\PYZus{}ratio\PYZus{}lep\PYZus{}tau}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\PY{p}{(}\PY{n}{train\PYZus{}DER\PYZus{}mass\PYZus{}transverse\PYZus{}met\PYZus{}lep}\PY{p}{,}
 \PY{n}{test\PYZus{}DER\PYZus{}mass\PYZus{}transverse\PYZus{}met\PYZus{}lep}\PY{p}{)} \PY{o}{=} \PY{n}{getFeatureSets}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{DER\PYZus{}mass\PYZus{}transverse\PYZus{}met\PYZus{}lep}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    We are able to achieve a higher AMS by adjusting the decision-threshold

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{customThreshold}\PY{p}{(}\PY{n}{predProb}\PY{p}{,}\PY{n}{t} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{:}
    \PY{n}{newPred} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{predProb}\PY{p}{)}\PY{p}{)}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{predProb}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{n}{predProb}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{t}\PY{p}{:}
            \PY{n}{newPred}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
    \PY{k}{return} \PY{n}{newPred}   
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{bestThreshold}\PY{p}{(}\PY{n}{predProb}\PY{p}{)}\PY{p}{:}
    \PY{n}{bestPred} \PY{o}{=} \PY{n}{predProb}
    \PY{n}{thresh} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{n}{maxAMS} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{n}{maxThresh} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{n}{newSignals} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{k}{for} \PY{n}{thresh} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{)}\PY{p}{:}
        \PY{n}{newPred} \PY{o}{=} \PY{n}{customThreshold}\PY{p}{(}\PY{n}{predProb}\PY{p}{,}\PY{n}{thresh}\PY{p}{)}
        \PY{n}{s}\PY{p}{,}\PY{n}{b} \PY{o}{=} \PY{n}{tb}\PY{o}{.}\PY{n}{calcWeightSums}\PY{p}{(}\PY{n}{test\PYZus{}weights}\PY{p}{,}\PY{n}{newPred}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}
        \PY{c}{\PYZsh{}print(\PYZdq{}s:\PYZdq{},s,\PYZdq{}b:\PYZdq{},b)}
        \PY{n}{ams} \PY{o}{=} \PY{n}{tb}\PY{o}{.}\PY{n}{calcAMS}\PY{p}{(}\PY{n}{s}\PY{p}{,}\PY{n}{b}\PY{p}{)}
        \PY{c}{\PYZsh{}print(\PYZdq{}ams:\PYZdq{},ams)}
        \PY{k}{if} \PY{n}{ams} \PY{o}{\PYZgt{}} \PY{n}{maxAMS}\PY{p}{:}
            \PY{n}{bestPred} \PY{o}{=} \PY{n}{newPred}
            \PY{n}{maxThresh} \PY{o}{=} \PY{n}{thresh}
            \PY{n}{maxAMS} \PY{o}{=} \PY{n}{ams}
            \PY{n}{newSignals} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{newPred}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
    \PY{c}{\PYZsh{}print(\PYZdq{}Maximum AMS:\PYZdq{},maxAMS, \PYZdq{}with threshold\PYZdq{}, maxThresh)}
    \PY{c}{\PYZsh{}print(\PYZdq{}Signals read:\PYZdq{}, newSignals)}
    \PY{k}{return} \PY{n}{bestPred}\PY{p}{,}\PY{n}{maxAMS}\PY{p}{,}\PY{n}{maxThresh}\PY{p}{,}\PY{n}{newSignals}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{compareBinaryArrays}\PY{p}{(}\PY{n}{a}\PY{p}{,}\PY{n}{b}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{shape}\PY{p}{(}\PY{n}{a}\PY{p}{)} \PY{o}{!=} \PY{n}{shape}\PY{p}{(}\PY{n}{b}\PY{p}{)}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{ERROR: Arrays must have same shape.}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{k}{return} \PY{k}{None}
    \PY{n}{eq\PYZus{}total} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{n}{eq\PYZus{}ones} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{n}{eq\PYZus{}zeros} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{a}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{n}{a}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{==} \PY{n}{b}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{:}
            \PY{n}{eq\PYZus{}total} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
            \PY{k}{if} \PY{n}{a}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                \PY{n}{eq\PYZus{}ones} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{eq\PYZus{}zeros} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
    \PY{k}{return} \PY{n}{eq\PYZus{}total}\PY{p}{,}\PY{n}{eq\PYZus{}ones}\PY{p}{,}\PY{n}{eq\PYZus{}zeros}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{fullEvaluation}\PY{p}{(}\PY{n}{predProb}\PY{p}{,}\PY{n}{pred}\PY{p}{,}\PY{n}{test\PYZus{}weights}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{:}
    \PY{n}{signals} \PY{o}{=} \PY{n}{pred}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{correct} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{equal}\PY{p}{(}\PY{n}{pred}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}    
    \PY{n}{s}\PY{p}{,}\PY{n}{b} \PY{o}{=} \PY{n}{tb}\PY{o}{.}\PY{n}{calcWeightSums}\PY{p}{(}\PY{n}{test\PYZus{}weights}\PY{p}{,}\PY{n}{pred}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}
    \PY{n}{ams} \PY{o}{=} \PY{n}{tb}\PY{o}{.}\PY{n}{calcAMS}\PY{p}{(}\PY{n}{s}\PY{p}{,}\PY{n}{b}\PY{p}{)}
   
    \PY{n}{newPred}\PY{p}{,}\PY{n}{maxAMS}\PY{p}{,}\PY{n}{maxThresh}\PY{p}{,}\PY{n}{newSignals} \PY{o}{=} \PY{n}{bestThreshold}\PY{p}{(}\PY{n}{predProb}\PY{p}{)}
    \PY{n}{newcorrect} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{equal}\PY{p}{(}\PY{n}{newPred}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
    
    \PY{n}{T\PYZus{}eq1}\PY{p}{,}\PY{n}{T\PYZus{}eq0} \PY{o}{=} \PY{n}{compareBinaryArrays}\PY{p}{(}\PY{n}{test\PYZus{}labels}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
    \PY{n}{o\PYZus{}eqt}\PY{p}{,}\PY{n}{o\PYZus{}eq1}\PY{p}{,}\PY{n}{o\PYZus{}eq0} \PY{o}{=} \PY{n}{compareBinaryArrays}\PY{p}{(}\PY{n}{pred}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}
    \PY{n}{a\PYZus{}eqt}\PY{p}{,}\PY{n}{a\PYZus{}eq1}\PY{p}{,}\PY{n}{a\PYZus{}eq0} \PY{o}{=} \PY{n}{compareBinaryArrays}\PY{p}{(}\PY{n}{newPred}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}
    
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Signals in test\PYZhy{}data:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{test\PYZus{}labels}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Comparison of [o]riginal and [a]djusted predictions:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{\PYZdq{}}\PY{o}{+}
          \PY{l+s}{\PYZdq{}}\PY{l+s}{ \PYZhy{} [o]Signals read:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{signals}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{\PYZdq{}}\PY{o}{+}
          \PY{l+s}{\PYZdq{}}\PY{l+s}{ \PYZhy{} [a]Signals read:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{newSignals}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{\PYZdq{}}\PY{o}{+}
          \PY{l+s}{\PYZdq{}}\PY{l+s}{ \PYZhy{}\PYZhy{} Difference:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{p}{(}\PY{n}{signals}\PY{o}{\PYZhy{}}\PY{n}{newSignals}\PY{p}{)}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{\PYZdq{}}\PY{o}{+}
          \PY{l+s}{\PYZdq{}}\PY{l+s}{ \PYZhy{} [o]Correct labels:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{o\PYZus{}eqt}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{| signals:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{o\PYZus{}eq1}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{| background:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{o\PYZus{}eq0}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{\PYZdq{}}\PY{o}{+}
          \PY{l+s}{\PYZdq{}}\PY{l+s}{ \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{} wrong signals:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{p}{(}\PY{n}{T\PYZus{}eq1}\PY{o}{\PYZhy{}}\PY{n}{o\PYZus{}eq1}\PY{p}{)}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{| background:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{p}{(}\PY{n}{T\PYZus{}eq0}\PY{o}{\PYZhy{}}\PY{n}{o\PYZus{}eq0}\PY{p}{)}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{\PYZdq{}}\PY{o}{+}
          \PY{l+s}{\PYZdq{}}\PY{l+s}{ \PYZhy{} [a]Correct labels:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{a\PYZus{}eqt}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{| signals:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{a\PYZus{}eq1}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{| background:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{a\PYZus{}eq0}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{\PYZdq{}}\PY{o}{+}
          \PY{l+s}{\PYZdq{}}\PY{l+s}{ \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{} wrong signals:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{p}{(}\PY{n}{T\PYZus{}eq1}\PY{o}{\PYZhy{}}\PY{n}{a\PYZus{}eq1}\PY{p}{)}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{| background:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{p}{(}\PY{n}{T\PYZus{}eq0}\PY{o}{\PYZhy{}}\PY{n}{a\PYZus{}eq0}\PY{p}{)}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{\PYZdq{}}\PY{o}{+}
          \PY{l+s}{\PYZdq{}}\PY{l+s}{ \PYZhy{}\PYZhy{} Difference labels:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{p}{(}\PY{n}{a\PYZus{}eqt}\PY{o}{\PYZhy{}}\PY{n}{o\PYZus{}eqt}\PY{p}{)}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{| signals:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{p}{(}\PY{n}{a\PYZus{}eq1}\PY{o}{\PYZhy{}}\PY{n}{o\PYZus{}eq1}\PY{p}{)}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{| background:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{p}{(}\PY{n}{a\PYZus{}eq0}\PY{o}{\PYZhy{}}\PY{n}{o\PYZus{}eq0}\PY{p}{)}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{\PYZdq{}}\PY{o}{+}
          \PY{l+s}{\PYZdq{}}\PY{l+s}{ \PYZhy{} [o]AMS:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{ams}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{\PYZdq{}}\PY{o}{+}
          \PY{l+s}{\PYZdq{}}\PY{l+s}{ \PYZhy{} [a]AMS:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{maxAMS}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{(threshold =}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{n}{maxThresh}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s}{)}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{\PYZdq{}}\PY{o}{+}
          \PY{l+s}{\PYZdq{}}\PY{l+s}{ \PYZhy{}\PYZhy{} Difference:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{p}{(}\PY{n}{ams}\PY{o}{\PYZhy{}}\PY{n}{maxAMS}\PY{p}{)}\PY{p}{,}\PY{l+s}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{\PYZdq{}}
         \PY{p}{)}
    \PY{k}{return} \PY{n}{pred}\PY{p}{,}\PY{n}{newPred}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}


    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{train\PYZus{}x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}
    \PY{p}{[}\PY{n}{train\PYZus{}PRI\PYZus{}tau\PYZus{}pt}\PY{p}{,}
     \PY{n}{train\PYZus{}DER\PYZus{}met\PYZus{}phi\PYZus{}centrality}\PY{p}{,}
     \PY{n}{train\PYZus{}DER\PYZus{}pt\PYZus{}h}\PY{p}{,}
     \PY{n}{train\PYZus{}DER\PYZus{}pt\PYZus{}ratio\PYZus{}lep\PYZus{}tau}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
\PY{n}{test\PYZus{}x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}
    \PY{p}{[}\PY{n}{test\PYZus{}PRI\PYZus{}tau\PYZus{}pt}\PY{p}{,}
     \PY{n}{test\PYZus{}DER\PYZus{}met\PYZus{}phi\PYZus{}centrality}\PY{p}{,}
     \PY{n}{test\PYZus{}DER\PYZus{}pt\PYZus{}h}\PY{p}{,}
     \PY{n}{test\PYZus{}DER\PYZus{}pt\PYZus{}ratio\PYZus{}lep\PYZus{}tau}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
\PY{p}{(}\PY{n}{predProb}\PY{p}{,}
 \PY{n}{pred}\PY{p}{)} \PY{o}{=} \PY{n}{logisticReg}\PY{p}{(}
    \PY{n}{train\PYZus{}x}\PY{p}{,}
    \PY{n}{train\PYZus{}labels}\PY{p}{,}
    \PY{n}{test\PYZus{}x}\PY{p}{,}
    \PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{;}
\PY{n}{fullEvaluation}\PY{p}{(}\PY{n}{predProb}\PY{p}{,}\PY{n}{pred}\PY{p}{,}\PY{n}{test\PYZus{}weights}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}

\par\vspace{1\smallerfontscale}%
    \needspace{4\baselineskip}%
    % Only render the prompt if the cell is pyout.  Note, the outputs prompt 
    % block isn't used since we need to check each indiviual output and only
    % add prompts to the pyout ones.
    %
    %
    \begin{addmargin}[\cellleftmargin]{0em}% left, right
    {\smaller%
    \vspace{-1\smallerfontscale}%
    
    \begin{Verbatim}[commandchars=\\\{\}]
Signals in test-data: 153683.0
Comparison of [o]riginal and [a]djusted predictions:
 - [o]Signals read: 88314.0 
 - [a]Signals read: 270377 
 -- Difference: -182063.0 
 - [o]Correct labels: 315491 | signals: 53744 | background: 261747 
 ----- wrong signals: 99939 | background: 34570 
 - [a]Correct labels: 275182 | signals: 124621 | background: 150561 
 ----- wrong signals: 29062 | background: 145756 
 -- Difference labels: -40309 | signals: 70877 | background: -111186 
 - [o]AMS: 1.3192322666968355 
 - [a]AMS: 1.4167498277657031 (threshold = 0.252525252525 )
 -- Difference: -0.09751756106886766
    \end{Verbatim}
}%
    \end{addmargin}%
    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{[o] correct signal/correct labels:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{p}{(}\PY{l+m+mi}{53744}\PY{o}{/}\PY{l+m+mi}{315491}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{[o] correct background/correct labels:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{p}{(}\PY{l+m+mi}{261747}\PY{o}{/}\PY{l+m+mi}{315491}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{[a] correct signal/correct labels:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{p}{(}\PY{l+m+mi}{124621}\PY{o}{/}\PY{l+m+mi}{275182}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{[a] correct background/correct labels:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{p}{(}\PY{l+m+mi}{150561}\PY{o}{/}\PY{l+m+mi}{275182}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{[o] wrong signal/wrong labels:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{p}{(}\PY{l+m+mi}{99939}\PY{o}{/}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{315491}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{[o] wrong background/wrong labels:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{p}{(}\PY{l+m+mi}{34570}\PY{o}{/}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{315491}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{[a] wrong signal/wrong labels:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{p}{(}\PY{l+m+mi}{29062}\PY{o}{/}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{275182}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{[a] wrong background/wrong labels:}\PY{l+s}{\PYZdq{}}\PY{p}{,}\PY{p}{(}\PY{l+m+mi}{145756}\PY{o}{/}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{275182}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}

\par\vspace{1\smallerfontscale}%
    \needspace{4\baselineskip}%
    % Only render the prompt if the cell is pyout.  Note, the outputs prompt 
    % block isn't used since we need to check each indiviual output and only
    % add prompts to the pyout ones.
    %
    %
    \begin{addmargin}[\cellleftmargin]{0em}% left, right
    {\smaller%
    \vspace{-1\smallerfontscale}%
    
    \begin{Verbatim}[commandchars=\\\{\}]
[o] correct signal/correct labels: 0.17035034279900219
[o] correct background/correct labels: 0.8296496572009978
[a] correct signal/correct labels: 0.4528675567442638
[a] correct background/correct labels: 0.5471324432557362

[o] wrong signal/wrong labels: 0.7429911753116892
[o] wrong background/wrong labels: 0.2570088246883108
[a] wrong signal/wrong labels: 0.16624146254962305
[a] wrong background/wrong labels: 0.833758537450377
    \end{Verbatim}
}%
    \end{addmargin}%
    By adjusting the threshold, we raise the rate of correct signals at the
expense of correctly predicted background-events. This results in a
higher AMS even though we softened our decision-threshold

    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{train\PYZus{}x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}
    \PY{p}{[}\PY{n}{train\PYZus{}PRI\PYZus{}tau\PYZus{}pt}\PY{p}{,}
     \PY{n}{train\PYZus{}DER\PYZus{}met\PYZus{}phi\PYZus{}centrality}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
\PY{n}{test\PYZus{}x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}
    \PY{p}{[}\PY{n}{test\PYZus{}PRI\PYZus{}tau\PYZus{}pt}\PY{p}{,}
     \PY{n}{test\PYZus{}DER\PYZus{}met\PYZus{}phi\PYZus{}centrality}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
\PY{n}{predProb}\PY{p}{,}\PY{n}{pred} \PY{o}{=} \PY{n}{logisticReg}\PY{p}{(}
    \PY{n}{train\PYZus{}x}\PY{p}{,}
    \PY{n}{train\PYZus{}labels}\PY{p}{,}
    \PY{n}{test\PYZus{}x}\PY{p}{,}
    \PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{;}
\PY{n}{fullEvaluation}\PY{p}{(}\PY{n}{predProb}\PY{p}{,}\PY{n}{pred}\PY{p}{,}\PY{n}{test\PYZus{}weights}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}

\par\vspace{1\smallerfontscale}%
    \needspace{4\baselineskip}%
    % Only render the prompt if the cell is pyout.  Note, the outputs prompt 
    % block isn't used since we need to check each indiviual output and only
    % add prompts to the pyout ones.
    %
    %
    \begin{addmargin}[\cellleftmargin]{0em}% left, right
    {\smaller%
    \vspace{-1\smallerfontscale}%
    
    \begin{Verbatim}[commandchars=\\\{\}]
Signals in test-data: 153683.0
Comparison of [o]riginal and [a]djusted predictions:
 - [o]Signals read: 70612.0 
 - [a]Signals read: 299182 
 -- Difference: -228570.0 
 - [o]Correct labels: 313525 | signals: 43910 | background: 269615 
 ----- wrong signals: 109773 | background: 26702 
 - [a]Correct labels: 259123 | signals: 130994 | background: 128129 
 ----- wrong signals: 22689 | background: 168188 
 -- Difference labels: -54402 | signals: 87084 | background: -141486 
 - [o]AMS: 1.1512119152385953 
 - [a]AMS: 1.3397092760005813 (threshold = 0.222222222222 )
 -- Difference: -0.18849736076198598
    \end{Verbatim}
}%
    \end{addmargin}%
    % Add contents below.

{\par%
\vspace{-1\baselineskip}%
\needspace{4\baselineskip}}%
\begin{notebookcell}[]%
\begin{addmargin}[\cellleftmargin]{0em}% left, right
{\smaller%
\par%
%
\vspace{-1\smallerfontscale}%
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{train\PYZus{}x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}
    \PY{p}{[}\PY{n}{train\PYZus{}DER\PYZus{}met\PYZus{}phi\PYZus{}centrality}\PY{p}{,}
     \PY{n}{train\PYZus{}DER\PYZus{}pt\PYZus{}ratio\PYZus{}lep\PYZus{}tau}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
\PY{n}{test\PYZus{}x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}
    \PY{p}{[}\PY{n}{test\PYZus{}DER\PYZus{}met\PYZus{}phi\PYZus{}centrality}\PY{p}{,}
     \PY{n}{test\PYZus{}DER\PYZus{}pt\PYZus{}ratio\PYZus{}lep\PYZus{}tau}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
\PY{n}{predProb}\PY{p}{,}\PY{n}{pred} \PY{o}{=} \PY{n}{logisticReg}\PY{p}{(}
    \PY{n}{train\PYZus{}x}\PY{p}{,}\PY{n}{train\PYZus{}labels}\PY{p}{,}
    \PY{n}{test\PYZus{}x}\PY{p}{,}
    \PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{;}
\PY{n}{fullEvaluation}\PY{p}{(}\PY{n}{predProb}\PY{p}{,}\PY{n}{pred}\PY{p}{,}\PY{n}{test\PYZus{}weights}\PY{p}{,}\PY{n}{test\PYZus{}labels}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
%
\par%
\vspace{-1\smallerfontscale}}%
\end{addmargin}
\end{notebookcell}

\par\vspace{1\smallerfontscale}%
    \needspace{4\baselineskip}%
    % Only render the prompt if the cell is pyout.  Note, the outputs prompt 
    % block isn't used since we need to check each indiviual output and only
    % add prompts to the pyout ones.
    %
    %
    \begin{addmargin}[\cellleftmargin]{0em}% left, right
    {\smaller%
    \vspace{-1\smallerfontscale}%
    
    \begin{Verbatim}[commandchars=\\\{\}]
Signals in test-data: 153683.0
Comparison of [o]riginal and [a]djusted predictions:
 - [o]Signals read: 105546.0 
 - [a]Signals read: 266339 
 -- Difference: -160793.0 
 - [o]Correct labels: 311453 | signals: 60341 | background: 251112 
 ----- wrong signals: 93342 | background: 45205 
 - [a]Correct labels: 273910 | signals: 121966 | background: 151944 
 ----- wrong signals: 31717 | background: 144373 
 -- Difference labels: -37543 | signals: 61625 | background: -99168 
 - [o]AMS: 1.3069521546244742 
 - [a]AMS: 1.4054130567873595 (threshold = 0.262626262626 )
 -- Difference: -0.09846090216288528
    \end{Verbatim}
}%
    \end{addmargin}%